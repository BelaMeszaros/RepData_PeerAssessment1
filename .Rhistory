install.packages("knitr")
install.packages("mice")
data <- read.csv("activity.csv", colClasses = c("numeric", "Date", "numeric"))
data1<-data[!is.na(data$steps),]
View(data1)
histdata<-aggregate(data1$steps,by=list(data1$date),FUN=sum)
hist(histdata$x, main = "total number of steps taken per day", xlab="steps", ylab="Frequency")
mean(histdata$x)
median(histdata$x)
timedata<-aggregate(data1$steps, by=list(data1$interval),FUN=sum)
plot(x=timedata$Group.1, y=timedata$x, type="l", main="average steps taken in a 5 minutes' period", xlab="timeperiod", ylab="steps")
index<-which.max(timedata$x)
print(timedata$x[index])
print(timedata$Group.1[index])
print(length(is.na(data$steps)))
dataImputed<-data
set.seed(0) # must be set as the imputation method "sample" is using random numbers
dataImputed[is.na(data$steps),"steps"]<-mice.impute.sample(data$steps, !is.na(data$steps))
histdata2<-aggregate(dataImputed$steps,by=list(dataImputed$date),FUN=sum)
hist(histdata2$x, main = "total number of steps taken per day (with imputed data)", xlab="steps", ylab="Frequency")
histdata$wd<-weekdays(histdata$Group.1)
weekend<-(histdata$wd == "Saturday" | histdata$wd == "Sunday")
plot(histdata$Group.1,histdata$x,type="n", main="step taken on weekdays/weekends", xlab="date", ylab="")
lines(histdata$Group.1[weekend],histdata$x[weekend], col="red")
lines(histdata$Group.1[!weekend],histdata$x[!weekend], col="blue")
text(x=as.Date("2012-11-22"),y=20000, labels="weekdays", col="blue", pos=2)
text(x=as.Date("2012-11-15"),y=15000, labels="weekdays", col="red", pos=2)
lines(histdata$Group.1[weekend],histdata$x[weekend], col="red")
dataImputed$wd<-weekdays(dataImputed$date)
data <- read.csv("activity.csv", colClasses = c("numeric", "Date", "numeric"))
data1<-data[!is.na(data$steps),]
library("mice")
dataImputed<-data
set.seed(0) # must be set as the imputation method "sample" is using random numbers
dataImputed[is.na(data$steps),"steps"]<-mice.impute.sample(data$steps, !is.na(data$steps))
Sys.setlocale("LC_TIME", "US") # Just for the case some run this script on computer with other settings
dataImputed$wd<-weekdays(dataImputed$date)
dataImputed$wd<-(weekdays(dataImputed$date) == "Saturday" | weekdays(dataImputed$date) == "Sunday")
View(dataImputed)
sum(dataImputed$wd)
plotData <- aggregate(dataImputed$steps,by=list(dataImputed$wd, dataImputed$interval),FUN=sum)
plot(plotData$Group.2,histdata$x,type="n", main="step taken on weekdays/weekends", xlab="date", ylab="")
plot(plotData$Group.2,plotData$x,type="n", main="step taken on weekdays/weekends", xlab="date", ylab="")
lines(plotData$Group.2[plotData$Group.1],histdata$x[plotData$Group.1], col="red")
lines(plotData$Group.2[plotData$Group.1],plotData$x[plotData$Group.1], col="red")
lines(plotData$Group.2[!plotData$Group.1],plotData$x[!plotData$Group.2], col="blue")
lines(plotData$Group.2[!plotData$Group.1],plotData$x[!plotData$Group.1], col="blue")
text(x=2000,y=200, labels="weekdays", col="blue", pos=2)
text(x=1000,y=300, labels="weekends", col="red", pos=2)
text(x=1000,y=5000, labels="weekdays", col="blue", pos=2)
text(x=2000,y=150, labels="weekends", col="red", pos=2)
text(x=1500,y=5000, labels="weekdays", col="blue", pos=2)
text(x=2000,y=150, labels="weekends", col="red", pos=2)
sd(data1$steps)
sd(data$steps)
sd(data1$steps)
